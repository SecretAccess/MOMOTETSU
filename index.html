<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>一度だけアクセスできるサイト</title>
    <style>
        #welcome, #restricted { display: none; }
    </style>
    <script>
        window.onload = function() {
            // 初回アクセス済みかどうかをlocalStorageでチェック
            if (localStorage.getItem('visited')) {
                // アクセス済みの場合、制限メッセージを表示
                document.getElementById("restricted").style.display = "block";
            } else {
                // 初回アクセスの場合、訪問フラグをセットし、ウェルカムメッセージを表示
                localStorage.setItem('visited', 'true');
                document.getElementById("welcome").style.display = "block";
            }
        };

        // リセットボタンの処理
        function resetAccess() {
            const password = prompt("リセットするにはパスワードを入力してください:");
            
            if (password === "0000") {
                // パスワードが正しい場合に確認メッセージを表示
                if (confirm("アクセス制限をリセットします。よろしいですか？")) {
                    localStorage.removeItem('visited'); // 訪問フラグを削除
                    alert("アクセス制限がリセットされました。再度アクセスが可能です。");
                    location.reload(); // ページをリロードして更新
                }
            } else {
                // パスワードが間違っている場合の警告
                alert("パスワードが間違っています。");
            }
        }

        // 再読み込みやページ離脱時に警告メッセージを表示
        window.addEventListener("beforeunload", function (e) {
            const message = "このページを再読み込みすると、再度アクセスできなくなります。本当にリロードしますか？";
            e.returnValue = message; // 標準の方法
            return message;           // 互換性のために追加
        });
    </script>
</head>
<body>
    <div id="welcome">
        <h1>ようこそ！このページは一度だけアクセス可能です。</h1>
        <p>このページは一度アクセスすると再度アクセスできません。</p>
    </div>
    <div id="restricted">
        <h1>アクセスは一度きりです。</h1>
        <p>このページには再度アクセスできません。</p>
    </div>

    <!-- 管理者用リセットボタン -->
    <button onclick="resetAccess()">アクセス制限をリセット</button>
</body>
</html>
